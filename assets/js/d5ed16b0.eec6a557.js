"use strict";(self.webpackChunkliangzai_for_hire=self.webpackChunkliangzai_for_hire||[]).push([[8854],{5680:(e,a,t)=>{t.d(a,{xA:()=>d,yg:()=>y});var n=t(6540);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=n.createContext({}),s=function(e){var a=n.useContext(c),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},d=function(e){var a=s(e.components);return n.createElement(c.Provider,{value:a},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,l=e.originalType,c=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=s(t),u=r,y=p["".concat(c,".").concat(u)]||p[u]||g[u]||l;return t?n.createElement(y,i(i({ref:a},d),{},{components:t})):n.createElement(y,i({ref:a},d))}));function y(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var l=t.length,i=new Array(l);i[0]=u;var o={};for(var c in a)hasOwnProperty.call(a,c)&&(o[c]=a[c]);o.originalType=e,o[p]="string"==typeof e?e:r,i[1]=o;for(var s=2;s<l;s++)i[s]=t[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5643:(e,a,t)=>{t.r(a),t.d(a,{contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var n=t(8168),r=(t(6540),t(5680));const l={sidebar_position:2,sidebar_label:"Life inside a cluster"},i="Life inside a cluster",o={unversionedId:"Backend/Database/Elastic Search/chapter-2",id:"Backend/Database/Elastic Search/chapter-2",title:"Life inside a cluster",description:"Terminology",source:"@site/docs/Backend/Database/Elastic Search/chapter-2.md",sourceDirName:"Backend/Database/Elastic Search",slug:"/Backend/Database/Elastic Search/chapter-2",permalink:"/docs/Backend/Database/Elastic Search/chapter-2",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Life inside a cluster"},sidebar:"docs",previous:{title:"Introduction",permalink:"/docs/Backend/Database/Elastic Search/chapter-1"},next:{title:"Data in, data out",permalink:"/docs/Backend/Database/Elastic Search/chapter-3"}},c=[{value:"Terminology",id:"terminology",children:[],level:2},{value:"Adding failover",id:"adding-failover",children:[],level:2},{value:"Horizontal scaling",id:"horizontal-scaling",children:[],level:2},{value:"Coping with failure",id:"coping-with-failure",children:[],level:2}],s={toc:c},d="wrapper";function p(e){let{components:a,...l}=e;return(0,r.yg)(d,(0,n.A)({},s,l,{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"life-inside-a-cluster"},"Life inside a cluster"),(0,r.yg)("h2",{id:"terminology"},"Terminology"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Term"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Node"),(0,r.yg)("td",{parentName:"tr",align:null},"Running instance of EES")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Cluster"),(0,r.yg)("td",{parentName:"tr",align:null},">= 1 node")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Master node"),(0,r.yg)("td",{parentName:"tr",align:null},"Single elected node in the cluster responsible for cluster wide changes (+/- index, +/- node)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Shard"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("ul",null,(0,r.yg)("li",null,"Containers of data (stores documents)"),(0,r.yg)("li",null,"Allocated to node")))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Primary Shard"),(0,r.yg)("td",{parentName:"tr",align:null},"Document store")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Replica Shard"),(0,r.yg)("td",{parentName:"tr",align:null},"Replica of primary shard")))),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Cluster diagram",src:t(2263).A})),(0,r.yg)("h2",{id:"adding-failover"},"Adding failover"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Avoid single point of failure by running multiple nodes")),(0,r.yg)("h2",{id:"horizontal-scaling"},"Horizontal scaling"),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Initial cluster",src:t(5191).A})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Adding one node")),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Horizontal scaling replicas",src:t(4602).A})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Increasing numebr of replicas")),(0,r.yg)("h2",{id:"coping-with-failure"},"Coping with failure"),(0,r.yg)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.yg)("div",{parentName:"div",className:"admonition-heading"},(0,r.yg)("h5",{parentName:"div"},(0,r.yg)("span",{parentName:"h5",className:"admonition-icon"},(0,r.yg)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.yg)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Scenario: One node killed")),(0,r.yg)("div",{parentName:"div",className:"admonition-content"},(0,r.yg)("p",{parentName:"div"},(0,r.yg)("img",{alt:"Node failure",src:t(5507).A})))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Actions:",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"One node promtoed to master (node 2)"),(0,r.yg)("li",{parentName:"ul"},"Replica shards promoted to primary shard"),(0,r.yg)("li",{parentName:"ul"},"Health check yellow (insufficient replicas)")))))}p.isMDXComponent=!0},2263:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/chapter2_cluster-0f6ce28ca53794b0566027d2c0cc7beb.png"},5507:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/chapter2_failure-63c160d2a9a81e904e480b8da6fe440f.png"},5191:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/chapter2_hscale-feec07f88c34b00d120a6e8b74ebc10d.png"},4602:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/chapter2_hscale_replica-5f6c5dff1b463df409a5edeedfda8536.png"}}]);